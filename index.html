<!DOCTYPE html>
<html>

<head>
    <meta charset="UTC-8" />
    <title>Jogo</title>
    <style>
        canvas {
            position: absolute;
            top: 0px;
            bottom: 0px;
            left: 0px;
            right: 0px;
            margin: auto;
        }
    </style>
    <SCRIPT LANGUAGE="JavaScript" SRC="keyboard.js"></SCRIPT> 
</head>

<body>
    <div class="row">
        <p>teste</p>
    </div>
    <script>
        //document.onkeydown = applyKey; 
        //Variaveis do jogo
        var status,
        pontosJogador=0,
        velocidade=0,
        
        canvas, ctx, ALTURA, LARGURA, frames = 0,maxPulos=5,

        chao = {
            y: 250,
            altura: 50,
            cor: "#ffdf70",

            desenha: function() {
                ctx.fillStyle = this.cor;
                ctx.fillRect(0, this.y, LARGURA, this.altura);
            }
        },
        personagem = {
            x: 50, y: 0,
            altura: 50,
            largura: 50,
            cor: "#ff4e4e",
            gravidade: 1.5,
            velocidade: 10,
            forcaDoPulo: 20,
            qntPulos: 0,
            andaFrente: function() {
                if ( this.x <= (LARGURA - this.largura - 30) ) {
                    this.x = this.x + 5;
                }
            },
            andaTras: function() {
                if ( this.x >= 30 ) {
                    this.x = this.x - 5;
                }
            },
            atualiza: function() {
                this.velocidade += this.gravidade;
                this.y += this.velocidade;

                if (this.y > chao.y - this.altura) {
                    this.y = chao.y - this.altura;
                    this.qntPulos = 0;
                }
            },
            pula: function() {
                if (this.qntPulos < maxPulos) {
                    this.velocidade = -this.forcaDoPulo;
                    this.qntPulos++;
                }
            },
            desenha: function() {
                ctx.fillStyle = this.cor;
                ctx.fillRect(this.x, this.y, this.largura, this.altura);
            }
        },
        bloco = {
            x: 650, y: 200,
            altura: 50,
            largura: 50,
            cor: "#ff4e4e",
            desenha: function() {
                this.x--;
                
                if(this.x<-50)
                    this.x=650;
                
                ctx.fillStyle = this.cor;
                ctx.fillRect(this.x, this.y, this.largura, this.altura);
            }
        };

        function checkEventObj(_event_) {
            // --- IE explorer 
            if (window.event)
                return window.event;
            // --- Netscape and other explorers 
            else
                return _event_;
        }

        function click(_event_) {
            // --- Retrieve event object from current web explorer 
            var winObj = checkEventObj(_event_);
            
            var intKeyCode = winObj.keyCode;
            var intAltKey = winObj.altKey;
            var intCtrlKey = winObj.ctrlKey;
            
            if(intKeyCode == KEY_UP){
                personagem.pula();
            }

            if (intKeyCode == KEY_RIGHT ) {

                personagem.andaFrente();

                // --- Map the keyCode in another keyCode not used 
                winObj.keyCode = intKeyCode = REMAP_KEY_T;
                winObj.returnValue = false;
                return false;
            }
            if (intKeyCode == KEY_LEFT ) {

                personagem.andaTras();

                // --- Map the keyCode in another keyCode not used 
                winObj.keyCode = intKeyCode = REMAP_KEY_T;
                winObj.returnValue = false;
                return false;
            }

        }

        function main() {
            AUTURA = window.innerHeight;
            LARGURA = window.innerWidth;

            // alert(LARGURA);
            if ( LARGURA >= 700 ) {
                LARGURA = 600;
                ALTURA = 300;
            }

            
            canvas = document.createElement("canvas");
            canvas.width = LARGURA;
            canvas.height = ALTURA;
            canvas.style.border = "1px solid #000";
            
            ctx = canvas.getContext("2d");
            document.body.appendChild(canvas);
            
            document.addEventListener("keydown", click);

            roda();
        }
        function roda() {
            atualiza();
            desenha();
            
            window.requestAnimationFrame(roda);
        }

        function atualiza() {
            frames = frames +1;
            pontosJogador = frames;

            personagem.atualiza();
            // Escreve placar
            
        }
        
        function desenha() {
            ctx.fillStyle = "#50beff";
            ctx.fillRect(0,0,LARGURA,ALTURA);
            
            chao.desenha();
            personagem.desenha();
            bloco.desenha();
            
            ctx.font = "20pt Tahoma";
            ctx.fillStyle = "#000";
            ctx.fillText("Pontuação:", 10, 35);
            ctx.fillText(pontosJogador, 10, 60);
        }

        //inicializa o jogo
        main();
    </script>
</body>

</html>